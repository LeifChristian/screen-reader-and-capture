<!DOCTYPE html>
<html>
  <head>
    <title>Region Overlay</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: transparent;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: transparent;
        pointer-events: none;
        z-index: 1000;
      }

      .region-box {
        position: absolute;
        border: 2px dashed #ff0000;
        background: transparent;
        pointer-events: none;
        display: none;
        z-index: 1001;
      }

      .region-box::before {
        content: "";
        position: absolute;
        top: -1px;
        left: -1px;
        right: -1px;
        bottom: -1px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        pointer-events: none;
      }

      .region-info {
        position: absolute;
        top: -30px;
        left: 0;
        background: rgba(255, 0, 0, 0.8);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        white-space: nowrap;
        pointer-events: none;
      }

      .region-info::before {
        content: "";
        position: absolute;
        top: 100%;
        left: 8px;
        border: 4px solid transparent;
        border-top-color: rgba(255, 0, 0, 0.8);
      }
    </style>
  </head>
  <body>
    <div class="overlay" id="overlay">
      <div class="region-box" id="regionBox">
        <div class="region-info" id="regionInfo">Target Region</div>
      </div>
    </div>

    <script>
      const { ipcRenderer } = require("electron");

      const regionBox = document.getElementById("regionBox");
      const regionInfo = document.getElementById("regionInfo");

      // Listen for region updates
      ipcRenderer.on("update-region", (event, region) => {
        if (region) {
          // Convert from screen coordinates to window coordinates
          const scaleFactor = window.devicePixelRatio || 1;
          const x = Math.round(region.x / scaleFactor);
          const y = Math.round(region.y / scaleFactor);
          const width = Math.round(region.width / scaleFactor);
          const height = Math.round(region.height / scaleFactor);

          regionBox.style.left = x + "px";
          regionBox.style.top = y + "px";
          regionBox.style.width = width + "px";
          regionBox.style.height = height + "px";
          regionBox.style.display = "block";

          regionInfo.textContent = `${width} Ã— ${height} at (${x}, ${y})`;
        } else {
          regionBox.style.display = "none";
        }
      });

      // Request current region on load
      ipcRenderer.send("get-current-region");

      // Focus window when loaded
      window.addEventListener("load", () => {
        document.body.style.pointerEvents = "none";
      });
    </script>
  </body>
</html>
